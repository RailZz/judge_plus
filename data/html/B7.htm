<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> <html><!--
 Archive processed by SingleFile 
 url: https://informatics.msk.ru/mod/statements/print3.php?id=33428 
 saved date: Fri Aug 24 2018 22:08:43 GMT+0300 (MSK) 
--><meta charset=utf-8>
<title>Параллель B. Динамическое программирование 2</title>
<style>.problem-statement{margin:.5em;font-family:verdana;line-height:1.5em;font-size:14px}.problem-statement p{margin:0 0 1em}.problem-statement .legend{margin-bottom:1em}.problem-statement .section-title{font-family:arial;font-size:115%;font-weight:bold}.problem-statement .output-specification{margin-bottom:1em}.problem-statement .sample-tests .input,.problem-statement .sample-tests .output{border:1px solid #888}.problem-statement .sample-tests .output{margin-bottom:1em;position:relative;top:-1px}.problem-statement .sample-tests pre{line-height:1.25em;padding:.25em;margin:0;background-color:#efefef}.problem-statement .sample-tests .title{font-family:arial;padding:.25em;border-bottom:1px solid #888;text-transform:lowercase;font-weight:bold}</style>
<meta name=description content="Параллель B. Динамическое программирование 2">
<style>h1,h2,h3,h4,h5,h6{margin-left:0;font-family:"Times New Roman",Times,serif;break-after:avoid;break-inside:avoid}.statements_title{margin-left:-40px;font-family:Tahoma,Verdana,Arial,Helvetica,sans-serif;font-size:3em;font-weight:bold;margin-top:120px;margin-bottom:30px;text-align:center}.statements_summary{margin-left:-40px;text-align:center;margin-bottom:120px}.statements_chapter_title{font-family:Tahoma,Verdana,Arial,Helvetica,sans-serif;text-align:left;font-size:1.7em;font-weight:bold;border-style:solid;border-width:0 0 1px;margin-left:0;margin-bottom:20px}.statements_chapter{break-before:page}body{margin-left:50px;margin-right:10px;color:#000;background-color:#fff;font-family:"Times New Roman",Times,serif;font-size:1em;font-weight:normal;text-decoration:none}font{color:#000;background-color:#eee;font-family:"Times New Roman",Times,serif;font-size:1em;font-weight:normal;text-decoration:none}.typeset{font-family:serif;font-style:normal;font-weight:normal;line-height:normal;text-indent:0}span.typeset{text-align:left}.typeset span{text-align:left;border:0;margin:0;padding:0}.typeset .size2{font-size:70%}.typeset .blank{display:inline-block;overflow:hidden;border:0 none;width:0;height:0}.typeset .spacer{display:inline-block}#jsMath_message{position:fixed;bottom:1px;left:2px;background-color:#e6e6e6;border:1px solid #959595;margin:0;padding:1px 8px;z-index:102;color:black;font-size:small;width:auto}#jsMath_button{position:fixed;bottom:1px;right:2px;background-color:white;border:1px solid #959595;margin:0;padding:0 3px 1px;z-index:102;color:black;text-decoration:none;font-size:x-small;width:auto;cursor:pointer}#jsMath_button *{padding:0;border:0;margin:0;line-height:normal;font-size:inherit;font-style:inherit;font-family:inherit}@media print{#jsMath_button{display:none}}.typeset .scale{font-size:120%}.typeset .icmr10{font-family:serif}.typeset .icmmi10{font-family:serif;font-style:italic}</style><link type=image/x-icon rel="shortcut icon" href=data:image/x-icon;base64,></head> <body><div id=jsMath_message style=visibility:visible;>Processing Math: Done</div><div id=jsMath_button title=" Open jsMath Control Panel "><span onclick=jsMath.Controls.Panel()>jsMath</span></div><div style="position:fixed;bottom:1px;left:2px;background-color:#e6e6e6;border:1px solid #959595;margin:0;padding:1px 8px;z-index:102;color:black;font-size:75%;width:auto;visibility:hidden;"></div> <a name=top></a> <p class=statements_title>Параллель B. Динамическое программирование 2</p> <p class=statements_summary></p>  <div class=statements_toc_alpha><a name=toc></a><p class=statements_chapter_title>Список задач<ul><li><a href=#ch491><b>Задача A.</b> Почти палиндром</a><li><a href=#ch3712><b>Задача B.</b> Логическое дерево</a><li><a href=#ch75><b>Задача C.</b> Симпатичные узоры</a><li><a href=#ch3862><b>Задача D.</b> Гном</a></ul></div><hr><div class=statements_chapter><h1><a name=ch491>Почти палиндром</a></h1><p class=statements_chapter_title><b>Задача A.</b> Почти палиндром<div class=problem-statement> <div class=legend> <p>Слово называется палиндромом, если его первая буква совпадает с последней, вторая – с предпоследней и т.д. Например: "abba", "madam", "x".</p> <p>Для заданного числа <i>K </i>слово называется <i>почти палиндромом</i>, если в нем можно изменить не более <i>K</i> любых букв так, чтобы получился палиндром. Например, при <i>K</i> = 2 слова "r<u>e</u>ac<u>t</u>or", "kolo<u>b</u><font face="Trebuchet MS, sans-serif">ok", "madam" являются <i>почти палиндромами</i> (подчеркнуты буквы, заменой которых можно получить палиндром).</font></p><font face="Trebuchet MS, sans-serif"> <p>Подсловом данного слова являются все слова, получающиеся путем вычеркивания из данного нескольких (возможно, одной или нуля) первых букв и нескольких последних. Например, подсловами слова "cat" являются слова "c", "a", "t", "ca", "at" и само слово "cat" (а "ct" подсловом слова "cat" не является).</p> <p>Требуется для данного числа <i>K </i>определить, сколько подслов данного слова <i>S </i>являются почти палиндромами.</p> </font></div><font face="Trebuchet MS, sans-serif"> <div class=input-specification> <div class=section-title> Входные данные </div> <p>В первой строке вводятся два натуральных числа:<i>N</i> (1 ≤ <i>N</i> ≤ 5 000) – длина слова и <i>K </i>(0 ≤ <i>K</i> ≤ <i>N</i>).</p> <p>Во второй строке&nbsp;содержится слово <i>S</i>, состоящее из <i>N</i> строчных латинских букв.</p> </div> <div class=output-specification> <div class=section-title> Выходные данные </div> <p>Требуется вывести одно число – количество подслов слова <i>S</i>, являющихся почти палиндромами (для данного <i>K</i>).</p> </div> </font></div><font face="Trebuchet MS, sans-serif"> <div class=problem-statement><div class=sample-tests><div class=section-title>Примеры</div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>5 1
abcde
</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>12
</pre></div></div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>3 3
aaa
</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>6
</pre></div></div></div></div></font></div><hr><div class=statements_chapter><h1><font face="Trebuchet MS, sans-serif"><a name=ch3712>Логическое дерево</a></font></h1><p class=statements_chapter_title><font face="Trebuchet MS, sans-serif"><b>Задача B.</b> Логическое дерево</font><div class=problem-statement><font face="Trebuchet MS, sans-serif"> <div class=legend> <p>Рассмотрим разновидность двоичного дерева, которую мы назовем логическим деревом. В&nbsp;этом дереве каждый уровень полностью заполнен, за&nbsp;исключением, возможно, последнего (самого глубокого) уровня. При&nbsp;этом все вершины последнего уровня находятся максимально слева. Дополнительно, каждая вершина дерева имеет ноль или двоих детей.</p> <p>Каждая вершина дерева имеет связанное с&nbsp;ней логическое значение (1 или&nbsp;0). Кроме этого, каждая <em>внутренняя</em> вершина имеет связанную с&nbsp;ней логическую операцию (<font face=serif>„И“</font> или&nbsp;<font face=serif>„ИЛИ“</font>). Значение вершины с&nbsp;операцией&nbsp;<font face=serif>„И“</font>&nbsp;— это логическое&nbsp;<font face=serif>„И“</font> значений её детей. Аналогично, значение вершины с&nbsp;операцией&nbsp;<font face=serif>„ИЛИ“</font>&nbsp;— это логическое&nbsp;<font face=serif>„ИЛИ“</font> значений её детей. Значения всех листьев задаются во&nbsp;входном файле, поэтому значения всех вершин дерева могут быть найдены.</p> <p>Наибольший интерес для нас представляет корень дерева. Мы хотим, чтобы он имел заданное логическое значение&nbsp;<span class=typeset><nobr><span class=scale><span class=icmmi10>v</span><span class=spacer style=margin-left:.035em></span></span></nobr></span>, которое может отличаться от&nbsp;текущего. К&nbsp;счастью, мы можем изменять логические операции некоторых внутренних вершин (заменить <font face=serif>„И“</font> на&nbsp;<font face=serif>„ИЛИ“</font> и&nbsp;наоборот).</p> <p>Дано описание логического дерева и&nbsp;набор вершин, операции в&nbsp;которых могут быть изменены. Найдите наименьшее количество вершин, которые следует изменить, чтобы корень дерева принял заданное значение&nbsp;<span class=typeset><nobr><span class=scale><span class=icmmi10>v</span><span class=spacer style=margin-left:.035em></span></span></nobr></span>. Если это невозможно, то выведите строку «<font face=monospace>IMPOSSIBLE</font>» (без кавычек).</p> </div> <div class=input-specification> <div class=section-title> Входные данные </div> <p>В&nbsp;первой строке входного файла находятся два числа <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> и&nbsp;<span class=typeset><nobr><span class=scale><span class=icmmi10>v</span><span class=spacer style=margin-left:.035em></span></span></nobr></span> (<span class=typeset><nobr><span class=scale><span style=position:relative;><span style=position:absolute;top:0;left:0;><span class=icmr10>1</span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmmi10>n</span></span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmr10>1</span></span><span class=icmr10>0</span><span style=position:relative;margin-left:.166em;><span class=icmr10>0</span></span><span class=icmr10>00</span><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAGCAQAAABOMPf+AAAAAmJLR0QA/4ePzL8AAAA0SURBVHjaBcExAYAgFAXA+8RgdDUFGyms4GJOGlDAEo874bH1htvlrYD6Kqjpb2BkCT3iABfOC+LQEMs0AAAAAElFTkSuQmCC style=width:4px;vertical-align:-4px;margin-right:.038em;><span style=position:relative;margin-left:.166em;><span class=icmr10>0</span></span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmmi10>v</span><span class=spacer style=margin-left:.035em></span></span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmr10>1</span></span>&nbsp;</span><span class=blank style=width:10.883em;height:.951em;></span></span><span class=blank style=height:1.034em;vertical-align:-0.244em></span></span></nobr></span>)&nbsp;— количество вершин в&nbsp;дереве и&nbsp;требуемое значение в&nbsp;корне соответственно. Поскольку все вершины имеют ноль или&nbsp;двоих детей, то&nbsp;<span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> нечётно. Следующие <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span>&nbsp;строк описывают вершины дерева. Вершины нумеруются от&nbsp;<span class=typeset><nobr><span class=scale><span class=icmr10>1</span></span></nobr></span> до&nbsp;<span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span>.</p> <p>Первые <span class=typeset><nobr><span class=scale><span style=position:relative;><span style=position:absolute;top:0;left:0;><span class=icmr10>(</span><span class=icmmi10>n</span><span style=position:relative;margin-left:.222em;><span class=icmsy10>−</span></span><span style=position:relative;margin-left:.222em;><span class=icmr10>1</span></span><span class=icmr10>)</span><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAASCAQAAADMS1f9AAAAAmJLR0QA/4ePzL8AAABwSURBVHjaXc6xDYAwDETRb8bIGJmCGShYgSGYg5KOHRgBCdHSULCGKYKcA6eJbD/rzKllia5Ba+TA5XE6smEtO+h8JTs/IMR6FhDCRpINS+A3EGRgfn96MIhlrojjOEy0cfwLnCYiV1IiC1FQGkkbDzRaVB5jETOHAAAAAElFTkSuQmCC style=height:18px;width:8px;vertical-align:-5px;margin-right:.020em;><span class=icmr10>2</span>&nbsp;</span><span class=blank style=width:3.687em;height:.951em;></span></span><span class=blank style=height:1.1em;vertical-align:-0.3em></span></span></nobr></span> строк описывают внутренние вершины. Каждая из&nbsp;них содержит два числа&nbsp;— <span class=typeset><nobr><span class=scale><span class=icmmi10>g</span><span class=spacer style=margin-left:.035em></span></span></nobr></span> и&nbsp;<span class=typeset><nobr><span class=scale><span class=icmmi10>c</span></span></nobr></span>, которые принимают значение либо&nbsp;<span class=typeset><nobr><span class=scale><span class=icmr10>0</span></span></nobr></span>, либо&nbsp;<span class=typeset><nobr><span class=scale><span class=icmr10>1</span></span></nobr></span>. Если <span class=typeset><nobr><span class=scale><span class=icmmi10>g</span><span class=spacer style=margin-left:.035em></span><span style=position:relative;margin-left:.277em;><span class=icmr10>=</span></span><span style=position:relative;margin-left:.277em;><span class=icmr10>1</span></span></span></nobr></span>, то&nbsp;вершина представляет логическую операцию <font face=serif>„И“</font>, иначе она представляет логическую операцию <font face=serif>„ИЛИ“</font>. Если <span class=typeset><nobr><span class=scale><span class=icmmi10>c</span><span style=position:relative;margin-left:.277em;><span class=icmr10>=</span></span><span style=position:relative;margin-left:.277em;><span class=icmr10>1</span></span></span></nobr></span>, то&nbsp;операция в&nbsp;вершине может быть изменена, иначе нет. Внутренняя вершина с&nbsp;номером&nbsp;<span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span> имеет детей <span class=typeset><nobr><span class=scale><span class=icmr10>2</span><span class=icmmi10>i</span></span></nobr></span> и&nbsp;<span class=typeset><nobr><span class=scale><span class=icmr10>2</span><span class=icmmi10>i</span><span style=position:relative;margin-left:.222em;><span class=icmr10>+</span></span><span style=position:relative;margin-left:.222em;><span class=icmr10>1</span></span></span></nobr></span>.</p> <p>Следующие <span class=typeset><nobr><span class=scale><span style=position:relative;><span style=position:absolute;top:0;left:0;><span class=icmr10>(</span><span class=icmmi10>n</span><span style=position:relative;margin-left:.222em;><span class=icmr10>+</span></span><span style=position:relative;margin-left:.222em;><span class=icmr10>1</span></span><span class=icmr10>)</span><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAASCAQAAADMS1f9AAAAAmJLR0QA/4ePzL8AAABwSURBVHjaXc6xDYAwDETRb8bIGJmCGShYgSGYg5KOHRgBCdHSULCGKYKcA6eJbD/rzKllia5Ba+TA5XE6smEtO+h8JTs/IMR6FhDCRpINS+A3EGRgfn96MIhlrojjOEy0cfwLnCYiV1IiC1FQGkkbDzRaVB5jETOHAAAAAElFTkSuQmCC style=height:18px;width:8px;vertical-align:-5px;margin-right:.020em;><span class=icmr10>2</span>&nbsp;</span><span class=blank style=width:3.687em;height:.951em;></span></span><span class=blank style=height:1.1em;vertical-align:-0.3em></span></span></nobr></span> строк описывают листья. Каждая строка содержит одно число <span class=typeset><nobr><span class=scale><span class=icmr10>0</span></span></nobr></span> или&nbsp;<span class=typeset><nobr><span class=scale><span class=icmr10>1</span></span></nobr></span>&nbsp;— значение листа.</p> </div> <div class=output-specification> <div class=section-title> Выходные данные </div> <p>В&nbsp;выходной файл выведите ответ на&nbsp;задачу.</p> </div> </font></div><font face="Trebuchet MS, sans-serif">
<div class=problem-statement><div class=sample-tests><div class=section-title>Примеры</div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>9 1
1 0
1 1
1 1
0 0
1
0
1
0
1
</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>1
</pre></div></div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>5 0
1 1
0 0
1
1
0
</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>IMPOSSIBLE
</pre></div></div></div></div></font></div><hr><div class=statements_chapter><h1><font face="Trebuchet MS, sans-serif"><a name=ch75>Симпатичные узоры</a></font></h1><p class=statements_chapter_title><font face="Trebuchet MS, sans-serif"><b>Задача C.</b> Симпатичные узоры</font><div class=problem-statement><font face="Trebuchet MS, sans-serif"> <div class=legend> <p>Компания BrokenTiles планирует заняться выкладыванием во дворах у состоятельных клиентов узоров из черных и белых плиток, каждая из которых имеет размер 1&nbsp;х 1 метр. Известно, что дворы всех состоятельных людей имеют наиболее модную на сегодня форму прямоугольника <em>N</em>&nbsp;х <em>M</em> метров. Однако при составлении финансового плана у директора этой организации появилось целых две серьезных проблемы: во-первых, каждый новый клиент, очевидно, захочет, чтобы узор, выложенный у него во дворе, отличался от узоров всех остальных клиентов этой фирмы, а во-вторых, этот узор должен быть симпатичным.</p> <p>Как показало исследование, узор является симпатичным, если в нем нигде не встречается квадрата 2&nbsp;х 2 метра, полностью покрытого плитками одного цвета. Для составления финансового плана директору Васе необходимо узнать, сколько клиентов он сможет обслужить, прежде чем симпатичные узоры данного размера закончатся. Помогите ему!</p> </div> </font><div class=input-specification><font face="Trebuchet MS, sans-serif"> <div class=section-title> Входные данные </div> </font><p><font face="Trebuchet MS, sans-serif">Вводятся два положительных целых числа <em>N</em> и <em>M</em> (1&nbsp;≤&nbsp;<em>N*</em><em>M</em>&nbsp;≤ 30).</font> </p> </div> <div class=output-specification> <div class=section-title> Выходные данные </div> <pвыведите единственное число &ndash; &nbsp;количество различных симпатичных узоров, которые можно выложить во дворе размера <em>N&nbsp;х <em>M.</em> Узоры, получающиеся друг из друга сдвигом, поворотом или отражением, считаются различными. <p></p>
<div class=problem-statement><div class=sample-tests><div class=section-title>Примеры</div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>1 2
</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>4
</pre></div></div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>2 3
</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>50
</pre></div></div></div></div></pвыведите></div><hr><div class=statements_chapter><h1><a name=ch3862>Гном</a></h1><p class=statements_chapter_title><b>Задача D.</b> Гном<div class=problem-statement> <div class=legend> <p>Как-то раз гному Кварку попала в руки карта сокровищ. На карте отмечено <span class=typeset><nobr><span class=scale><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span></span></nobr></span> точек, в которых может находиться клад. Все точки пронумерованы числами от <span class=typeset><nobr><span class=scale><span class=icmr10>1</span></span></nobr></span> до <span class=typeset><nobr><span class=scale><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span></span></nobr></span>. Для каждой пары точек Кварк знает длину дороги, их соединяющей. Свои поиски Кварк начинает от точки с номером <span class=typeset><nobr><span class=scale><span class=icmr10>1</span></span></nobr></span>. Прежде чем начать свой долгий путь, хитрый гном вычеркивает точки, в которых, по его мнению, клада быть не может. Гарантируется, что точка с номером <span class=typeset><nobr><span class=scale><span class=icmr10>1</span></span></nobr></span> никогда не бывает вычеркнута. После этого Кварк выбирает некоторый маршрут, проходящий через все оставшиеся на карте точки. Маршрут не проходит через одну и ту же точку более одного раза. Кварк может ходить только по дорогам, соединяющим невычеркнутые точки.</p> <p>Кварк хочет выбрать маршрут минимальной длины. Необходимо найти такой маршрут для Кварка.</p> </div> <div class=input-specification> <div class=section-title> Входные данные </div> <p>В первой строке находится одно целое число <span class=typeset><nobr><span class=scale><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span></span></nobr></span> <span class=typeset><nobr><span class=scale><span class=icmr10>(1</span><span style=position:relative;margin-left:.277em;><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAALCAQAAADheaTUAAAAAmJLR0QA/4ePzL8AAABVSURBVHjabY9BDcBACAQHG5ipE1Rg4kQgDRUVQD9Nc5SDB2FhM1kpTiVKjcZI4i86SRTFLi6S9W3vCBJv3gLnxgapQOf/xuiEBu/HmcJJApVTcjGuB24IYsHkLWyaAAAAAElFTkSuQmCC style=width:12px;vertical-align:-1px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span></span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmr10>1</span></span><span class=icmr10>5)</span></span></nobr></span> — количество точек, отмеченных на карте. В последующих <span class=typeset><nobr><span class=scale><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span></span></nobr></span> строках находятся расстояния между точками. В <span class=typeset><nobr><span class=scale><span class=icmr10>(</span><span class=icmmi10>i</span><span style=position:relative;margin-left:.222em;><span class=icmr10>+</span></span><span style=position:relative;margin-left:.222em;><span class=icmr10>1</span></span><span class=icmr10>)</span></span></nobr></span>-й строке находятся <span class=typeset><nobr><span class=scale><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span></span></nobr></span> целых чисел <span class=typeset><nobr><span class=scale><span class=icmmi10>d</span><span style=position:relative;top:.277em;><span class=size2><span class=icmmi10>i</span><span class=icmr10>1</span></span><span class=spacer style=margin-left:.05em></span></span><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAGCAQAAABOMPf+AAAAAmJLR0QA/4ePzL8AAAA0SURBVHjaBcExAYAgFAXA+8RgdDUFGyms4GJOGlDAEo874bH1htvlrYD6Kqjpb2BkCT3iABfOC+LQEMs0AAAAAElFTkSuQmCC style=width:4px;vertical-align:-4px;margin-right:.038em;><span style=position:relative;margin-left:.333em;><span class=icmmi10>d</span><span style=position:relative;top:.277em;><span class=size2><span class=icmmi10>i</span><span class=icmr10>2</span></span><span class=spacer style=margin-left:.05em></span></span></span><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAGCAQAAABOMPf+AAAAAmJLR0QA/4ePzL8AAAA0SURBVHjaBcExAYAgFAXA+8RgdDUFGyms4GJOGlDAEo874bH1htvlrYD6Kqjpb2BkCT3iABfOC+LQEMs0AAAAAElFTkSuQmCC style=width:4px;vertical-align:-4px;margin-right:.038em;><span style=position:relative;margin-left:.333em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAACCAQAAADVobXoAAAAAmJLR0QA/4ePzL8AAAAaSURBVHjaY/jPwBDHcJdBiomBgUGMQY5BAgAidwKjTsq27wAAAABJRU5ErkJggg==" style=width:4px;margin-right:.038em;><span style=position:relative;margin-left:.166em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAACCAQAAADVobXoAAAAAmJLR0QA/4ePzL8AAAAaSURBVHjaY/jPwBDHcJdBiomBgUGMQY5BAgAidwKjTsq27wAAAABJRU5ErkJggg==" style=width:4px;margin-right:.038em;></span><span style=position:relative;margin-left:.166em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAACCAQAAADVobXoAAAAAmJLR0QA/4ePzL8AAAAaSURBVHjaY/jPwBDHcJdBiomBgUGMQY5BAgAidwKjTsq27wAAAABJRU5ErkJggg==" style=width:4px;margin-right:.038em;></span></span><span style=position:relative;margin-left:.166em;><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAGCAQAAABOMPf+AAAAAmJLR0QA/4ePzL8AAAA0SURBVHjaBcExAYAgFAXA+8RgdDUFGyms4GJOGlDAEo874bH1htvlrYD6Kqjpb2BkCT3iABfOC+LQEMs0AAAAAElFTkSuQmCC style=width:4px;vertical-align:-4px;margin-right:.038em;></span><span style=position:relative;margin-left:.333em;><span class=icmmi10>d</span><span style=position:relative;top:.277em;><span class=size2><span class=icmmi10>i</span></span><span class=size2><span class=icmmi10>N</span></span><span class=spacer style=margin-left:.076em></span><span class=spacer style=margin-left:.05em></span></span></span><span class=blank style=height:1.117em;vertical-align:-0.327em></span></span></nobr></span> — длины дорог от <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>-й точки до всех остальных. Гарантируется, что <span class=typeset><nobr><span class=scale><span class=icmmi10>d</span><span style=position:relative;top:.277em;><span class=size2><span class=icmmi10>i</span></span><span class=size2><span class=icmmi10>j</span></span><span class=spacer style=margin-left:.040em></span><span class=spacer style=margin-left:.05em></span></span><span style=position:relative;margin-left:.277em;><span class=icmr10>=</span></span><span style=position:relative;margin-left:.277em;><span class=icmmi10>d</span><span style=position:relative;top:.277em;><span class=size2><span class=icmmi10>ji</span></span><span class=spacer style=margin-left:.05em></span></span></span><span class=blank style=height:1.257em;vertical-align:-0.467em></span></span></nobr></span>, <span class=typeset><nobr><span class=scale><span class=icmmi10>d</span><span style=position:relative;top:.277em;><span class=size2><span class=icmmi10>ii</span></span><span class=spacer style=margin-left:.05em></span></span><span style=position:relative;margin-left:.277em;><span class=icmr10>=</span></span><span style=position:relative;margin-left:.277em;><span class=icmr10>0</span></span><span class=blank style=height:1.117em;vertical-align:-0.327em></span></span></nobr></span> и <span class=typeset><nobr><span class=scale><span class=icmr10>0</span><span style=position:relative;margin-left:.277em;><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAALCAQAAADheaTUAAAAAmJLR0QA/4ePzL8AAABVSURBVHjabY9BDcBACAQHG5ipE1Rg4kQgDRUVQD9Nc5SDB2FhM1kpTiVKjcZI4i86SRTFLi6S9W3vCBJv3gLnxgapQOf/xuiEBu/HmcJJApVTcjGuB24IYsHkLWyaAAAAAElFTkSuQmCC style=width:12px;vertical-align:-1px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmmi10>d</span><span style=position:relative;top:.277em;><span class=size2><span class=icmmi10>i</span></span><span class=size2><span class=icmmi10>j</span></span><span class=spacer style=margin-left:.040em></span><span class=spacer style=margin-left:.05em></span></span></span><span style=position:relative;margin-left:.277em;><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAALCAQAAADheaTUAAAAAmJLR0QA/4ePzL8AAABVSURBVHjabY9BDcBACAQHG5ipE1Rg4kQgDRUVQD9Nc5SDB2FhM1kpTiVKjcZI4i86SRTFLi6S9W3vCBJv3gLnxgapQOf/xuiEBu/HmcJJApVTcjGuB24IYsHkLWyaAAAAAElFTkSuQmCC style=width:12px;vertical-align:-1px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmr10>1</span></span><span class=icmr10>00</span><span class=blank style=height:1.257em;vertical-align:-0.467em></span></span></nobr></span>. В <span class=typeset><nobr><span class=scale><span class=icmr10>(</span><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span><span style=position:relative;margin-left:.222em;><span class=icmr10>+</span></span><span style=position:relative;margin-left:.222em;><span class=icmr10>2</span></span><span class=icmr10>)</span></span></nobr></span>-й строке находится одно целое число <span class=typeset><nobr><span class=scale><span class=icmmi10>Q</span></span></nobr></span> <span class=typeset><nobr><span class=scale><span class=icmr10>(1</span><span style=position:relative;margin-left:.277em;><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAALCAQAAADheaTUAAAAAmJLR0QA/4ePzL8AAABVSURBVHjabY9BDcBACAQHG5ipE1Rg4kQgDRUVQD9Nc5SDB2FhM1kpTiVKjcZI4i86SRTFLi6S9W3vCBJv3gLnxgapQOf/xuiEBu/HmcJJApVTcjGuB24IYsHkLWyaAAAAAElFTkSuQmCC style=width:12px;vertical-align:-1px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmmi10>Q</span></span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmr10>1</span></span><span class=icmr10>000)</span></span></nobr></span> — количество вариантов вычеркивания точек для данной карты. В последующих <span class=typeset><nobr><span class=scale><span class=icmmi10>Q</span></span></nobr></span> строках содержится описание вариантов вычеркивания. Описание начинается с числа <span class=typeset><nobr><span class=scale><span class=icmmi10>C</span><span class=spacer style=margin-left:.071em></span></span></nobr></span> <span class=typeset><nobr><span class=scale><span class=icmr10>(0</span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmmi10>C</span></span><span style=position:relative;margin-left:.277em;><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAALCAQAAADheaTUAAAAAmJLR0QA/4ePzL8AAABVSURBVHjabY9BDcBACAQHG5ipE1Rg4kQgDRUVQD9Nc5SDB2FhM1kpTiVKjcZI4i86SRTFLi6S9W3vCBJv3gLnxgapQOf/xuiEBu/HmcJJApVTcjGuB24IYsHkLWyaAAAAAElFTkSuQmCC style=width:12px;vertical-align:-1px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span></span><span class=icmr10>)</span></span></nobr></span> — количества точек, в которых, по мнению Кварка, клада быть не может. Следующие <span class=typeset><nobr><span class=scale><span class=icmmi10>C</span><span class=spacer style=margin-left:.071em></span></span></nobr></span> чисел задают номера этих точек.</p> </div> <div class=output-specification> <div class=section-title> Выходные данные </div> <p>Выведите <span class=typeset><nobr><span class=scale><span class=icmmi10>Q</span></span></nobr></span> строк. В каждой строке выведите одно целое число — длину минимального маршрута при соответствующем варианте вычеркивания точек.</p> </div> </div>
<div class=problem-statement><div class=sample-tests><div class=section-title>Примеры</div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>3
0  45 10
45 0  30
10 30 0
2
0
1 3
</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>40
45
</pre></div></div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>5
0  14 20 17 14
14 0  15 19 18
20 15 0  15 16
17 19 15 0  14
14 18 16 14 0
2
3 5 4 3
0
</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>14
58
</pre></div></div></div></div></div> </div></div><autoscroll></autoscroll>