<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> <html><!--
 Archive processed by SingleFile 
 url: https://informatics.msk.ru/mod/statements/print3.php?id=33394 
 saved date: Sun Aug 19 2018 21:56:00 GMT+0300 (MSK) 
--><meta charset=utf-8>
<title>Параллель B. Топологическая сортировка и конденсация</title>
<style>.problem-statement{margin:.5em;font-family:verdana;line-height:1.5em;font-size:14px}.problem-statement p{margin:0 0 1em}.problem-statement .legend{margin-bottom:1em}.problem-statement .section-title{font-family:arial;font-size:115%;font-weight:bold}.problem-statement .output-specification{margin-bottom:1em}.problem-statement .sample-tests .input,.problem-statement .sample-tests .output{border:1px solid #888}.problem-statement .sample-tests .output{margin-bottom:1em;position:relative;top:-1px}.problem-statement .sample-tests pre{line-height:1.25em;padding:.25em;margin:0;background-color:#efefef}.problem-statement .sample-tests .title{font-family:arial;padding:.25em;border-bottom:1px solid #888;text-transform:lowercase;font-weight:bold}</style>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta http-equiv=Content-Type content="text/html; charset=">
<meta name=description content="Параллель B. Топологическая сортировка и конденсация">
<style>h1,h2,h3,h4,h5,h6{margin-left:0;font-family:"Times New Roman",Times,serif;break-after:avoid;break-inside:avoid}.statements_title{margin-left:-40px;font-family:Tahoma,Verdana,Arial,Helvetica,sans-serif;font-size:3em;font-weight:bold;margin-top:120px;margin-bottom:30px;text-align:center}.statements_summary{margin-left:-40px;text-align:center;margin-bottom:120px}.statements_chapter_title{font-family:Tahoma,Verdana,Arial,Helvetica,sans-serif;text-align:left;font-size:1.7em;font-weight:bold;border-style:solid;border-width:0 0 1px;margin-left:0;margin-bottom:20px}.statements_chapter{break-before:page}body{margin-left:50px;margin-right:10px;color:#000;background-color:#fff;font-family:"Times New Roman",Times,serif;font-size:1em;font-weight:normal;text-decoration:none}font{color:#000;background-color:#eee;font-family:"Times New Roman",Times,serif;font-size:1em;font-weight:normal;text-decoration:none}.typeset{font-family:serif;font-style:normal;font-weight:normal;line-height:normal;text-indent:0}span.typeset{text-align:left}.typeset span{text-align:left;border:0;margin:0;padding:0}.typeset .size2{font-size:70%}.typeset .blank{display:inline-block;overflow:hidden;border:0 none;width:0;height:0}.typeset .spacer{display:inline-block}#jsMath_message{position:fixed;bottom:1px;left:2px;background-color:#e6e6e6;border:1px solid #959595;margin:0;padding:1px 8px;z-index:102;color:black;font-size:small;width:auto}#jsMath_button{position:fixed;bottom:1px;right:2px;background-color:white;border:1px solid #959595;margin:0;padding:0 3px 1px;z-index:102;color:black;text-decoration:none;font-size:x-small;width:auto;cursor:pointer}#jsMath_button *{padding:0;border:0;margin:0;line-height:normal;font-size:inherit;font-style:inherit;font-family:inherit}@media print{#jsMath_button{display:none}}.typeset .scale{font-size:120%}.typeset .icmr10{font-family:serif}.typeset .icmmi10{font-family:serif;font-style:italic}</style><link type=image/x-icon rel="shortcut icon" href=data:image/x-icon;base64,></head> <body><div id=jsMath_message style=visibility:hidden;>Processing Math: Done</div><div id=jsMath_button title=" Open jsMath Control Panel "><span onclick=jsMath.Controls.Panel()>jsMath</span></div><div style="position:fixed;bottom:1px;left:2px;background-color:#e6e6e6;border:1px solid #959595;margin:0;padding:1px 8px;z-index:102;color:black;font-size:75%;width:auto;visibility:hidden;"></div> <a name=top></a> <p class=statements_title>Параллель B. Топологическая сортировка и конденсация</p> <p class=statements_summary></p>  <div class=statements_toc_alpha><a name=toc></a><p class=statements_chapter_title>Список задач<ul><li><a href=#ch166><b>Задача A.</b> Построение</a><li><a href=#ch1991><b>Задача B.</b> Конденсация графа</a><li><a href=#ch1978><b>Задача C.</b> Расписание электричек</a><li><a href=#ch1928><b>Задача D.</b> Производство деталей</a><li><a href=#ch112751><b>Задача E.</b> Магические порталы</a></ul></div><hr><div class=statements_chapter><h1><a name=ch166>Построение</a></h1><p class=statements_chapter_title><b>Задача A.</b> Построение<div class=problem-statement> <div class=legend> <p>Группа солдат-новобранцев прибыла в армейскую часть N666. После знакомства с прапорщиком стало очевидно, что от работ на кухне по очистке картофеля спасти солдат может только чудо.</p>
<p>Прапорщик, будучи не в состоянии запомнить фамилии, пронумеровал новобранцев от 1 до <em>N</em>. После этого он велел им построиться по росту (начиная с самого высокого). С этой несложной задачей могут справиться даже совсем необученные новобранцы, да вот беда, прапорщик уверил себя, что знает про некоторых солдат, кто из них кого выше, и это далеко не всегда соответствует истине.</p>
<p>После трех дней обучения новобранцам удалось выяснить, что знает (а точнее, думает, что знает) прапорщик. Помогите им, используя эти знания, построиться так, чтобы товарищ прапорщик остался доволен.</p> </div> <div class=input-specification> <div class=section-title> Входные данные </div> <p>Сначала&nbsp;на вход программы поступают&nbsp;числа <em>N</em> и <em>M</em> (1 &lt; <em>N</em> &lt;= 100, 1 &lt;= <em>M</em> &lt;= 5000)&nbsp;– количество солдат в роте и количество пар солдат, про которых прапорщик знает, кто из них выше. Далее идут эти пары чисел <em>A</em> и <em>B</em> по одной на строке (1 &lt;= <em>A</em>,<em>B</em> &lt;= <em>N</em>), что означает, что, по мнению прапорщика, солдат <em>A</em> выше, чем <em>B</em>. Не гарантируется, что все пары чисел во входных данных различны.</p> </div> <div class=output-specification> <div class=section-title> Выходные данные </div> <p>В первой строке выведите "<font face="courier new,courier,monospace">Yes"</font> (если можно построиться так, чтобы прапорщик остался доволен) или "<font face="courier new,courier,monospace">No</font>" (если нет). После ответа "<font face="courier new,courier,monospace">Yes</font>" на следующей строке выведите <em>N</em> чисел, разделенных пробелами, - одно из возможных построений.</p> </div> </div> <div class=problem-statement><div class=sample-tests><div class=section-title>Примеры</div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>4 5
1 2
2 3
3 4
1 4
4 1</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>No</pre></div></div></div></div></div><hr><div class=statements_chapter><h1><a name=ch1991>Конденсация графа</a></h1><p class=statements_chapter_title><b>Задача B.</b> Конденсация графа<div class=problem-statement> <div class=legend> <p>Вам задан ориентированный граф с <span class=typeset><nobr><span class=scale><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span></span></nobr></span> вершинами и <span class=typeset><nobr><span class=scale><span class=icmmi10>M</span><span class=spacer style=margin-left:.109em></span></span></nobr></span> ребрами (<span class=typeset><nobr><span class=scale><span class=icmr10>1</span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span></span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmr10>2</span></span><span class=icmr10>0000</span></span></nobr></span>, <span class=typeset><nobr><span class=scale><span class=icmr10>1</span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmmi10>M</span><span class=spacer style=margin-left:.109em></span></span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmr10>2</span></span><span class=icmr10>00000</span></span></nobr></span>). Найдите компоненты сильной связности заданного графа и топологически отсортируйте его конденсацию.</p> </div> <div class=input-specification> <div class=section-title> Входные данные </div> <p>Граф задан во входном файле следующим образом: первая строка содержит числа <span class=typeset><nobr><span class=scale><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span></span></nobr></span> и <span class=typeset><nobr><span class=scale><span class=icmmi10>M</span><span class=spacer style=margin-left:.109em></span></span></nobr></span>. Каждая из следующих <span class=typeset><nobr><span class=scale><span class=icmmi10>M</span><span class=spacer style=margin-left:.109em></span></span></nobr></span> строк содержит описание ребра — два целых числа из диапазона от <span class=typeset><nobr><span class=scale><span class=icmr10>1</span></span></nobr></span> до <span class=typeset><nobr><span class=scale><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span></span></nobr></span> — номера начала и конца ребра.</p> </div> <div class=output-specification> <div class=section-title> Выходные данные </div> <p>На первой строке выведите число <span class=typeset><nobr><span class=scale><span class=icmmi10>K</span><span class=spacer style=margin-left:.071em></span></span></nobr></span> — количество компонент сильной связности в заданном графе. На следующей строке выведите <span class=typeset><nobr><span class=scale><span class=icmmi10>N</span><span class=spacer style=margin-left:.109em></span></span></nobr></span> чисел — для каждой вершины выведите номер компоненты сильной связности, которой принадлежит эта вершина. Компоненты сильной связности должны быть занумерованы таким образом, чтобы для любого ребра номер компоненты сильной связности его начала не превышал номера компоненты сильной связности его конца.</p> </div> </div>
<div class=problem-statement><div class=sample-tests><div class=section-title>Примеры</div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>10 19
1 4
7 8
5 10
8 9
9 6
2 6
6 2
3 8
9 2
7 2
9 7
4 5
3 6
7 3
6 7
10 8
10 1
2 9
2 7
</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>2
1 2 2 1 1 2 2 2 2 1 
</pre></div></div></div></div></div><hr><div class=statements_chapter><h1><a name=ch1978>Расписание электричек</a></h1><p class=statements_chapter_title><b>Задача C.</b> Расписание электричек<div class=problem-statement> <div class=legend> <p>Рассмотрим расписание движения электричек на некоторой железнодорожной линии. Нас будут интересовать только электрички, идущие в одном направлении.</p> <p>Каждая электричка отправляется с некоторой станции и следует до некоторой другой станции со всеми остановками. При этом средняя маршрутная скорость у каждой электрички своя (будем считать, что весь маршрут электричка проходит с этой скоростью, временем стоянки на станциях пренебрежем). Поскольку на участке только один путь в данном направлении — электрички в процессе следования друг друга не обгоняют.</p> <p>Требуется выпустить книжку-расписание электричек. Обычно такая книжка представляет собой таблицу, где в первом столбце перечислены все станции, а каждый следующий столбец соответствует электричке: если электричка проходит через станцию, то в соответствующей клетке указывается время прохождения этой электрички через эту станцию, и прочерк, если электричка через эту станцию не проходит.</p> <p>Естественно, что в книжке-расписании нужно расположить электрички так, чтобы они были указаны в хронологическом порядке. А именно, если две электрички имеют хотя бы одну общую станцию (даже если она является начальной станцией для одной, и конечной — для другой электрички), электрички в расписании должны идти в том порядке, в каком они проходят через эту станцию (поскольку электрички не обгоняют друг друга, то это же будет справедливо для всех общих станций этих двух электричек). Если же электрички не имеют ни одной общей станции, то они могут быть указаны в любом порядке.</p> <p>По данному расписанию движения электричек определите порядок, в котором электрички должны идти в книжке—расписании.</p> </div> <div class=input-specification> <div class=section-title> Входные данные </div> <p>Сначала вводится целое число <em>N</em> (1 ≤ <em><span>N</span></em><span> </span><span>≤ 1000) — количество электричек. Далее идёт описание электричек: каждая электричка задается четырьмя числами <em>A</em></span><em><sub><span>i</span></sub></em><span>, </span><em><span>B<sub>i</sub></span></em><span>, </span><em><span>C<sub>i</sub></span></em><span>, </span><em><span>D<sub>i</sub></span></em><span> (0 ≤ </span><em><span>A<sub>i</sub></span></em><span> &lt; </span><em><span>B<sub>i</sub></span></em><span> </span><span>≤ 10<sup>6</sup>, 1&nbsp;≤ </span><em><span>C<sub>i</sub></span></em><span> </span><span>≤ 100, 0 ≤ </span><em><span>D<sub>i</sub></span></em><span> </span><span>≤ 10000), которые обозначают, что данная электричка отправляется со станции «<em>A</em></span><em><sub><span>i</span></sub></em><span>-й километр» и следует до станции «</span><em><span>B<sub>i</sub></span></em><span>-й километр». Электричка отправляется с начальной станции в момент </span><em><span>C<sub>i</sub></span></em><span>. Один километр электричка проезжает за </span><em><span>D<sub>i</sub></span></em><span> секунд.</span></p> <p>Гарантируется, что расписание можно составить корректно, в частности, никакая электричка не обгоняет другую.</p> </div> <div class=output-specification> <div class=section-title> Выходные данные </div> <p>Выведите последовательность из <em>N</em> номеров от 1 до <em>N</em> – номера электричек в том порядке, в котором они должны идти в книжке-расписании. Если возможных ответов несколько, выведите любой.</p> <p><strong><em>Комментарий к примеру тестов</em></strong></p> <p>Ответ 2 3 1 также будет верным.</p> </div> </div>
<div class=problem-statement><div class=sample-tests><div class=section-title>Примеры</div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>3
1 10 3 4
3 5 3 4
10 11 10 1

</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>3 2 1 
</pre></div></div></div></div></div><hr><div class=statements_chapter><h1><a name=ch1928>Производство деталей</a></h1><p class=statements_chapter_title><b>Задача D.</b> Производство деталей<div class=problem-statement> <div class=legend> <p> Предприятие «Авто-2010» выпускает двигатели для известных во всём мире автомобилей. Двигатель состоит ровно из <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> деталей, пронумерованных от 1 до <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span>, при этом деталь с номером <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span> изготавливается за <span class=typeset><nobr><span class=scale><span class=icmmi10>p</span><span style=position:relative;top:.277em;><span class=size2><span class=icmmi10>i</span></span><span class=spacer style=margin-left:.05em></span></span><span class=blank style=height:.850em;vertical-align:-0.327em></span></span></nobr></span> секунд. Специфика предприятия «Авто-2010» заключается в том, что там одновременно может изготавливаться лишь одна деталь двигателя. Для производства некоторых деталей необходимо иметь предварительно изготовленный набор других деталей. <p> Генеральный директор «Авто-2010» поставил перед предприятием амбициозную задачу — за наименьшее время изготовить деталь с номером 1, чтобы представить её на выставке. <p> Требуется написать программу, которая по заданным зависимостям порядка производства между деталями найдёт наименьшее время, за которое можно произвести деталь с номером 1. </p> </div> <div class=input-specification> <div class=section-title> Входные данные </div> <p> Первая строка входного файла содержит число <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> (<span class=typeset><nobr><span class=scale><span class=icmr10>1</span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmmi10>n</span></span><span style=position:relative;margin-left:.277em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAOCAQAAACxtDVnAAAAAmJLR0QA/4ePzL8AAACDSURBVHjadY+hEQIxEEXfZq6KCCQKlRJOxdJA+kFQQmqIZc5cCTFnUwGGDhaTHBwh+9W+P//vrCj9yI2z6WCUwlOv6C4skUKo2w4TucFq4FjJeOVbBrhwYtHHz7EaDBQi9lClHzOTmsmxGU9mxSnSPyiOOy/59zmAGXAmEMfc8W2YeANOykjYbhilhAAAAABJRU5ErkJggg==" style=width:12px;vertical-align:-3px;margin-right:.059em;></span><span style=position:relative;margin-left:.277em;><span class=icmr10>1</span></span><span class=icmr10>00000</span></span></nobr></span>) — количество деталей двигателя. Вторая строка содержит <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> натуральных чисел <span class=typeset><nobr><span class=scale><span class=icmmi10>p</span><span style=position:relative;top:.277em;><span class=size2><span class=icmr10>1</span></span><span class=spacer style=margin-left:.05em></span></span><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAGCAQAAABOMPf+AAAAAmJLR0QA/4ePzL8AAAA0SURBVHjaBcExAYAgFAXA+8RgdDUFGyms4GJOGlDAEo874bH1htvlrYD6Kqjpb2BkCT3iABfOC+LQEMs0AAAAAElFTkSuQmCC style=width:4px;vertical-align:-4px;margin-right:.038em;><span style=position:relative;margin-left:.166em;><span class=icmmi10>p</span><span style=position:relative;top:.277em;><span class=size2><span class=icmr10>2</span></span><span class=spacer style=margin-left:.05em></span></span></span><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAGCAQAAABOMPf+AAAAAmJLR0QA/4ePzL8AAAA0SURBVHjaBcExAYAgFAXA+8RgdDUFGyms4GJOGlDAEo874bH1htvlrYD6Kqjpb2BkCT3iABfOC+LQEMs0AAAAAElFTkSuQmCC style=width:4px;vertical-align:-4px;margin-right:.038em;><span style=position:relative;margin-left:.166em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAACCAQAAADVobXoAAAAAmJLR0QA/4ePzL8AAAAaSURBVHjaY/jPwBDHcJdBiomBgUGMQY5BAgAidwKjTsq27wAAAABJRU5ErkJggg==" style=width:4px;margin-right:.038em;><span style=position:relative;margin-left:.166em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAACCAQAAADVobXoAAAAAmJLR0QA/4ePzL8AAAAaSURBVHjaY/jPwBDHcJdBiomBgUGMQY5BAgAidwKjTsq27wAAAABJRU5ErkJggg==" style=width:4px;margin-right:.038em;></span><span style=position:relative;margin-left:.166em;><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAACCAQAAADVobXoAAAAAmJLR0QA/4ePzL8AAAAaSURBVHjaY/jPwBDHcJdBiomBgUGMQY5BAgAidwKjTsq27wAAAABJRU5ErkJggg==" style=width:4px;margin-right:.038em;></span></span><span style=position:relative;margin-left:.166em;><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAGCAQAAABOMPf+AAAAAmJLR0QA/4ePzL8AAAA0SURBVHjaBcExAYAgFAXA+8RgdDUFGyms4GJOGlDAEo874bH1htvlrYD6Kqjpb2BkCT3iABfOC+LQEMs0AAAAAElFTkSuQmCC style=width:4px;vertical-align:-4px;margin-right:.038em;></span><span style=position:relative;margin-left:.166em;><span class=icmmi10>p</span><span style=position:relative;top:.15em;><span class=size2><span class=icmmi10>n</span></span><span class=spacer style=margin-left:.05em></span></span></span><span class=blank style=height:.850em;vertical-align:-0.327em></span></span></nobr></span>, определяющих время изготовления каждой детали в секундах. Время для изготовления каждой детали не превосходит <span class=typeset><nobr><span class=scale><span class=icmr10>1</span><span class=icmr10>0</span><span style=position:relative;top:-0.362em;><span class=size2><span class=icmr10>9</span></span><span class=spacer style=margin-left:.05em></span></span></span></nobr></span> секунд. <p> Каждая из последующих <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> строк входного файла описывает характеристики производства деталей. Здесь <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>-я строка содержит число деталей <span class=typeset><nobr><span class=scale><span class=icmmi10>k</span><span style=position:relative;top:.277em;><span class=size2><span class=icmmi10>i</span></span><span class=spacer style=margin-left:.05em></span></span><span class=blank style=height:1.117em;vertical-align:-0.327em></span></span></nobr></span>, которые требуются для производства детали с номером <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>, а также их номера. В <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>-й строке нет повторяющихся номеров деталей. Сумма всех чисел <span class=typeset><nobr><span class=scale><span class=icmmi10>k</span><span style=position:relative;top:.277em;><span class=size2><span class=icmmi10>i</span></span><span class=spacer style=margin-left:.05em></span></span><span class=blank style=height:1.117em;vertical-align:-0.327em></span></span></nobr></span> не превосходит 200000. <p> Известно, что не существует циклических зависимостей в производстве деталей. </p> </div> <div class=output-specification> <div class=section-title> Выходные данные </div> <p> В первой строке выходного файла должны содержаться два числа: минимальное время (в секундах), необходимое для скорейшего производства детали с номером 1 и число <span class=typeset><nobr><span class=scale><span class=icmmi10>k</span><span class=spacer style=margin-left:.031em></span></span></nobr></span> деталей, которые необходимо для этого произвести. Во второй строке требуется вывести через пробел <span class=typeset><nobr><span class=scale><span class=icmmi10>k</span><span class=spacer style=margin-left:.031em></span></span></nobr></span> чисел — номера деталей в том порядке, в котором следует их производить для скорейшего производства детали с номером 1. </p> </div> </div> <div class=problem-statement><div class=sample-tests><div class=section-title>Примеры</div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>3
100 200 300
1 2
0
2 2 1</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>300 2
2 1</pre></div></div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>2
2 3
1 2
0</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>5 2
2 1</pre></div></div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>4
2 3 4 5
2 3 2
1 3
0
2 1 3</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>9 3
3 2 1</pre></div></div></div></div></div><hr><div class=statements_chapter><h1><a name=ch112751>Магические порталы</a></h1><p class=statements_chapter_title><b>Задача E.</b> Магические порталы<div class=problem-statement> <div class=legend> <p> В некотором королевстве есть <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> городов, соединенных магическими порталами. Каждая пара различных городов соединена ровно одним магическим порталом, позволяющим мгновенно перемещаться из одного города в другой. <br><br> Из-за свойств магии, определяющей работу порталов, каждый портал можно использовать только в одну сторону. Для каждой пары городов <span class=typeset><nobr><span class=scale><span class=icmmi10>A</span></span></nobr></span> и <span class=typeset><nobr><span class=scale><span class=icmmi10>B</span><span class=spacer style=margin-left:.050em></span></span></nobr></span> известно, можно ли воспользоваться порталом для перемещения напрямую из <span class=typeset><nobr><span class=scale><span class=icmmi10>A</span></span></nobr></span> в <span class=typeset><nobr><span class=scale><span class=icmmi10>B</span><span class=spacer style=margin-left:.050em></span></span></nobr></span> или из <span class=typeset><nobr><span class=scale><span class=icmmi10>B</span><span class=spacer style=margin-left:.050em></span></span></nobr></span> в <span class=typeset><nobr><span class=scale><span class=icmmi10>A</span></span></nobr></span>.<br><br> Из-за особенностей магических порталов иногда при перемещении жителей королевства из одного города в другой приходится использовать несколько порталов. Также могут существовать такие пары городов, что из одного города в другой нельзя добраться, используя только магические порталы. <br><br> Жители королевства называют город совершенным, если из него можно добраться до любого другого города в королевстве, используя только магические порталы. Пусть изначально количество совершенных городов в королевстве равно <span class=typeset><nobr><span class=scale><span class=icmmi10>k</span><span class=spacer style=margin-left:.031em></span></span></nobr></span>.<br><br> Недавно король принял решение выбрать пару городов и изменить разрешенное направление перемещения по порталу, соединяющему их, на противоположное. Для выбора лучшего варианта король хочет понять, какое количество совершенных городов может оказаться в королевстве после перенастройки ровно одного портала.<br><br> Для получения этой информации король планирует запросить в министерстве транспорта соответствующий отчет. Король может запросить либо частичный, либо полный отчет. Содержимое отчета зависит от параметра <span class=typeset><nobr><span class=scale><span class=icmmi10>L</span></span></nobr></span>, для частичного отчета <span class=typeset><nobr><span class=scale><span class=icmmi10>L</span></span></nobr></span> = <span class=typeset><nobr><span class=scale><span class=icmmi10>k</span><span class=spacer style=margin-left:.031em></span></span></nobr></span> + 1, для полного отчета <span class=typeset><nobr><span class=scale><span class=icmmi10>L</span></span></nobr></span> = 1.<br><br> Отчет содержит для каждого целого числа <span class=typeset><nobr><span class=scale><span class=icmmi10>m</span></span></nobr></span>, такого что <span class=typeset><nobr><span class=scale><span class=icmmi10>m</span></span></nobr></span> ≥ <span class=typeset><nobr><span class=scale><span class=icmmi10>L</span></span></nobr></span>, число таких пар городов <span class=typeset><nobr><span class=scale><span class=icmmi10>A</span></span></nobr></span> и <span class=typeset><nobr><span class=scale><span class=icmmi10>B</span><span class=spacer style=margin-left:.050em></span></span></nobr></span>, для которых выполняются следующие условия:<br> * исходно магический портал позволяет перемещаться напрямую из города <span class=typeset><nobr><span class=scale><span class=icmmi10>A</span></span></nobr></span> в город <span class=typeset><nobr><span class=scale><span class=icmmi10>B</span><span class=spacer style=margin-left:.050em></span></span></nobr></span>;<br> * если изменить направление перемещения этого магического портала на противоположное, чтобы он позволял напрямую перемещаться из города <span class=typeset><nobr><span class=scale><span class=icmmi10>B</span><span class=spacer style=margin-left:.050em></span></span></nobr></span> в город <span class=typeset><nobr><span class=scale><span class=icmmi10>A</span></span></nobr></span>, то количество совершенных городов в королевстве станет равным <span class=typeset><nobr><span class=scale><span class=icmmi10>m</span></span></nobr></span>.<br><br> Таким образом, частичный отчет содержит информацию только о тех способах перенастройки одного портала, которые строго увеличивают количество совершенных городов в королевстве. Полный отчет содержит информацию обо всех способах перенастройки одного портала.<br><br> Требуется написать программу, которая по информации о разрешенных направлениях перемещения с использованием магических порталов, и информации о том, требуется предоставить частичный или полный отчет, формирует соответствующий отчет и выводит его в описанном ниже формате. </p> </div> <div class=input-specification> <div class=section-title> Входные данные </div> <p> Первая строка входного файла содержит два целых числа: <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> — количество городов в королевстве (2 ≤ <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> ≤ 2000) и <span class=typeset><nobr><span class=scale><span class=icmmi10>p</span></span></nobr></span>, равное либо 0, если требуется вывести частичный отчет, либо 1, если требуется вывести полный отчет.<br><br> Последующие <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> строк содержат по <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> символов, каждый из которых может быть «+», «–» или «.», и <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>-я из этих строк описывает магические порталы, соединяющие <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>-й город с другими городами.<br><br> В <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>-й строке <span class=typeset><nobr><span class=scale><span class=icmmi10>j</span><span class=spacer style=margin-left:.057em></span></span></nobr></span>-й символ равен «+», если магический портал позволяет напрямую перемещаться из <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>-го города в <span class=typeset><nobr><span class=scale><span class=icmmi10>j</span><span class=spacer style=margin-left:.057em></span></span></nobr></span>-й, равен «–», если магический портал позволяет напрямую перемещаться из <span class=typeset><nobr><span class=scale><span class=icmmi10>j</span><span class=spacer style=margin-left:.057em></span></span></nobr></span>-го города в <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>-й, и равен «.», если <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span> = <span class=typeset><nobr><span class=scale><span class=icmmi10>j</span><span class=spacer style=margin-left:.057em></span></span></nobr></span>. </p> </div> <div class=output-specification> <div class=section-title> Выходные данные </div> <p> Первая строка выходного файла должна содержать одно целое число <span class=typeset><nobr><span class=scale><span class=icmmi10>k</span><span class=spacer style=margin-left:.031em></span></span></nobr></span> — количество совершенных городов в королевстве.<br><br> Если требуется частичный отчет (<span class=typeset><nobr><span class=scale><span class=icmmi10>p</span></span></nobr></span> = 0), то вторая строка выходного файла должна содержать (<span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> – <span class=typeset><nobr><span class=scale><span class=icmmi10>k</span><span class=spacer style=margin-left:.031em></span></span></nobr></span>) целых неотрицательных чисел, разделенных пробелами, где <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>-е из этих чисел должно быть равно количеству пар городов, изменение направления портала между которыми на противоположное приводит к тому, что количество совершенных городов в королевстве станет равным (<span class=typeset><nobr><span class=scale><span class=icmmi10>k</span><span class=spacer style=margin-left:.031em></span></span></nobr></span> + <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>). Если при этом <span class=typeset><nobr><span class=scale><span class=icmmi10>k</span><span class=spacer style=margin-left:.031em></span></span></nobr></span> = <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span>, то вторая строка может отсутствовать, либо быть пустой.<br><br> Если требуется полный отчет (<span class=typeset><nobr><span class=scale><span class=icmmi10>p</span></span></nobr></span> = 1), то вторая строка должна содержать <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> целых неотрицательных чисел, разделенных пробелами, где <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>-е из этих чисел должно быть равно количеству пар городов, изменение направления портала между которыми на противоположное приводит к тому, что количество совершенных городов в королевстве станет равным <span class=typeset><nobr><span class=scale><span class=icmmi10>i</span></span></nobr></span>. </p> </div> <div class=output-specification> <div class=section-title> Пояснения к примеру </div> <p> В приведенных примерах изначально совершенным является только город 2. Изменив направление порталов, соединяющих пары городов (2, 3), (2, 4) или (2, 5), можно сделать все города совершенными. Изменение направление любого другого портала делает совершенным один город.<br><br> Внимание! Второй тест не подходит под ограничения для первых трех подзадач, но решение принимается на проверку только в том случае, если оно выводит правильный ответ на все тесты из примера. Решение должно выводить правильный ответ на второй тест даже, если оно рассчитано на решение только каких-либо подзадач из первых трех.<br><br> В других тестах <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> ≠ 5. </p> </div> <div class=output-specification> <div class=section-title> Система оценки и описание подзадач </div>
<br> <p> В этой задаче четыре подзадачи. Баллы за каждую подзадачу начисляются только в случае, если все тесты подзадачи пройдены.<br>
<b>Подзадача 1 (20 баллов)</b><br> 2 ≤ <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> ≤ 50, <span class=typeset><nobr><span class=scale><span class=icmmi10>p</span></span></nobr></span> = 0<br>
<b>Подзадача 2 (30 баллов)</b><br> 2 ≤ <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> ≤ 300, <span class=typeset><nobr><span class=scale><span class=icmmi10>p</span></span></nobr></span> = 0<br>
<b>Подзадача 3 (20 баллов)</b><br> 2 ≤ <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> ≤ 2000, <span class=typeset><nobr><span class=scale><span class=icmmi10>p</span></span></nobr></span> = 0<br>
<b>Подзадача 4 (30 баллов)</b><br> 2 ≤ <span class=typeset><nobr><span class=scale><span class=icmmi10>n</span></span></nobr></span> ≤ 2000, <span class=typeset><nobr><span class=scale><span class=icmmi10>p</span></span></nobr></span> = 1 </p> </div><div class=problem-statement><div class=sample-tests><div class=section-title>Примеры</div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>5 0
.-+++
+.+++
--.+-
---.+
--+-.
</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>1
0 0 0 3
</pre></div></div><div class=sample-test><div class=input><div class=title>Входные данные</div><pre class=content>5 1
.-+++
+.+++
--.+-
---.+
--+-.
</pre></div><div class=output><div class=title>Выходные данные</div><pre class=content>1
7 0 0 0 3
</pre></div></div></div></div></div> </div><autoscroll></autoscroll>